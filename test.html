
<!doctype html>
<html>
    <head>
        
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="dist/jquery.cloudsearch.js"></script>
        <script src="dist/jquery.cloudsearch.suggester.js"></script>
        <!-- <script src="dist/jquery-ui.min.js"></script>
        <link rel="stylesheet" href="dist/jquery-ui.min.css" /> -->

    </head>
    <body>
        <h1>Hello World</h1>

        <div class="input-wrapper">
            <input type="text" id="searchInput" value="" placeholder="Start typing" />
            <input type="text" id="fromDate" data-date-dir="fromDate" placeholder="from">
            <input type="text" id="toDate" data-date-dir="toDate" placeholder="to">
        </div>

        <table>
            <tbody>
                <tr>
                    <td style="vertical-align: top;">
                        <div id="tps-aws-facet-list" style="outline: 1px solid red;"></div>
                    </td>
                    <td>
                        <div id="tps-aws-active-facets"></div>
                        <div id="tps-aws-results"></div>
                        <div id="tps-aws-results-pager"></div>
                    </td>                    
                </tr>
            </tbody>
        </table>

        

        <script>

            var SearchOptions = {
                cloudSearch: {
                    url: 'https:\/\/1gcvo6mof9.execute-api.us-east-1.amazonaws.com\/rcm-site-search-beta',
                    // key: 'Hh4O1adBCAardxSjFyPK471wauiRZnvyJ5USNbkh'
                },
                results: {
                    container: '#tps-aws-results',                    
                    pager: {
                        appendPager: true,
                        container: '#tps-aws-results-pager',
                        loadMore: false,
                        pagerRangeIncrement: 5,
                        enders: true,
                        labels: {
                            prev : '< Previous',
                            next : 'Next >',
                            first: '<< First',
                            last: 'Last >>'
                        }
                    },
                    template: `
                        <div>
                            <div data-cloudsearch-field="documentname" data-cloudsearch-value-format="tps_format_test" data-cloudsearch-value-format-replace></div>
                            <div data-cloudsearch-field="newsarticledate"></div>
                        </div>`,
                },
                facets: {
                    container: "#tps-aws-facet-list",  
                    facet: '<a href=\"#\"/>',
                    facetClass: 'facet search-filter-options',
                    countWrapper: '<span/>',
                    countWrapperClass: 'facet-count',
                    titleWrapper: '',
                    title: "<a href=\"#\" />",
                    titleClass: "accordion-title",
                    titleWrapperClass: "facet-title",
                    wrapperContainer: "<div data-tab-content />",
                    wrapperContainerClass: "accordion-content facet-accordion-content content-area",
                    wrapper: "<div>",
                    wrapperClass: "facet-item",
                    groupWrapper: '<li data-accordion-item />',
                    groupWrapperClass: 'accordion-item tps-accordion-item is-active'
                },
                dates: {
                    hasDates: true,
                    fields: {
                        cloudSearchField: 'newsarticledate',     
                        zone: null,                   
                        from: {
                            selector: '#fromDate'
                        },
                        to: {
                            selector: '#toDate'
                        }
                    }
                },
                facetsApplied: {
                    container: '#tps-aws-active-facets',
                },
                searchParams: {
                    q: "matchall",
                    return: "menuitemname,menuitemimage,menuitemsummary,menuitemcalltoactiontext,nodealiaspath,documentname,newsarticledate,newsarticlecategories,_score",
                    //return: '_all_fields',
                    size: 5, // page size
                    sort: "newsarticledate asc,_score desc",
                    start: 0, // offset starting result (pagination)
                    "q.parser" : "structured",
                    "q.options" : "{ fields: [ 'documentname^5', 'menuitemname^5', 'menuitemsummary^2' ] }",                    
                    // fq: "classname: 'TPSDT.NewsArticle'"

                },
                facetsDictionary: { 
                    "newsarticlecategories" : "",
                    "newsarticletags" : "",
                    "classname" : ""
                },

            }         

            var suggesterOptions = {
                cloudSuggester : {
                    url: 'https://u1htsx5gpg.execute-api.us-east-1.amazonaws.com/rcm-site-search-suggester-beta',

                },
                searchParams: {
                    suggester: 'rcmusic_suggester'
                },

            }

            $(document).ready(function(){                
                $('#tps-aws-results').cloudsearch(SearchOptions);

                /*
                $( '#searchInput' ).autocomplete({
                    source: function(inputText, setSource) {
                        suggesterOptions.searchParams.q = inputText.term;
                        suggesterOptions.onLoad = function(a) {                            
                            var suggArr = [];
                            $.each(this.suggest.suggestions, function(k,v){
                                suggArr.push(v.suggestion)
                            });
                            setSource(suggArr);
                        }
                        var suggestionObj = $(document).cloudsearchSuggester(suggesterOptions);
                    }
                });
                */

            });

            tps_format_test = function(value, resultsObject) {
                // console.log(value);
                // console.log(resultsObject);
                return '<h2>' + value + '</h2>';
            } 
        </script>
    </body>
</html>


<!-- 

     var ls = {
       
        
        results: {
            container: '#results',
            template: null,
            onCreate: function () { },
            alwaysClearContainer: false
        },
        
        
    };


 -->